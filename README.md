# Proof of Goods and Services : <br> Threshold multi-signatures demo

## Warning

This multi-signatures demo is currently in the development phase and subjects to changes. Before proceeding, please be aware of the following:

- This sample is for demonstration purposes only, do not use in production systems or mainnet in the future.

- Do not transfer any ERC20 tokens to addresses generated by this demo as it can cause loss of funds.

Crypto.com is not liable for any potential damage, loss of data/files arising from the use of the multi-signatures demo.

## Task lists :

- [x] Merchant panel
- [ ] Escrow panel
- [ ] Support enviornment with fees

## About this Demo

This demo is to demonstrate a 2-of-3 [multisignature scheme](https://en.bitcoin.it/wiki/Multisignature) under the setting of **"Proof of Goods & Services Delivered"** (PoGSD) collaterals in the Cryptop.com Chain protocol. For more detail, please refer to the [use case example](#Use-case-example) in the later section.

## Build

### Build Prerequisites

- Crypto.com Chain - [Sample-chain-wallet](https://github.com/crypto-com/sample-chain-wallet/tree/multi-sig-demo). <br>
  - To enable multi-sig feature please change to the [branch](https://github.com/crypto-com/sample-chain-wallet/tree/multi-sig-demo) `multi-sig-demo` on sample-chain-wallet.
- The current version only supports zero fee environment, to enable zero fee on Crypto.com Chain, please kindly:

  - Update below fields in `.tendermint/config/genesis.json`:

    ```javascript
    "initial_fee_policy": {
        "base_fee": "0.0",
        "per_byte_fee": "0.0"
    }
    ```

- Install [Diesel](https://diesel.rs/guides/getting-started/)

  ```bash
  $ cargo install diesel_cli --no-default-features --features sqlite
  ```

### Build instructions

- #### Multi-sig web backend

```bash
$ cd backend
$ diesel setup
$ cargo run
```

For ubuntu :

```bash
$ sudo apt-get install libsqlite3-dev
```

For fedora :

```bash
$ sudo dnf install libsqlite3x-devel
```

- #### Multi-sig web frontend

```bash
$ cd frontend
$ npm install
$ npm run start -- --port 4201
```

Once the backend and the frontend are running, you can navigate to http://localhost:4201/ and interact with the web interface. See also the [graphical instruction](https://github.com/crypto-com/multisig-demo/tree/master/frontend) for PoGSD demo frontend

## Use case example

The following use case example demonstrates the interaction between _customer_, _escrow_ and _merchant_ in where the customer is purchase items from the _merchant_ with "Proof of Goods and Services"

- _Customer_ selects items, and select “proof-of-goods-and-services”;
- _Customer_ retrieves invoice info from _merchant_'s web;
- Total amount (items price + deposit) and public keys from _merchant_ and _escrow_ retrieved through APIs.
- The _customer_ then sends the total amount to a 2-of-3 multi-signature address generated based on the public keys from the parties involved.

Under this 2-of-3 multi-signature scheme, at least two of the three signatures (approvals) are required to "unlock" and spend the funds in the multi-signature address.

### Scenario A: The item is shipped

#### A1) **Normal case**

- Signatures: _Customer_ + _Merchant_

If the _customer_ confirms and accepts the delivered item, he/she can complete the purchase by co-signing the transaction to the _merchant_ with his/her signature.

#### A2) Payment dispute _(Escrow involved)_

- Signatures: _Customer_ + _Escrow_

If the _merchant_ has not received the payment after a certain period of time, he/she can contact and provide evidence of delivery to the _escrow_. Once it has been confirmed, the transaction will be co-signed by the _escrow_ and the funds will be released to the _merchant_.

### Scenario B: The item is not shipped/not as described

#### B1) Reimbursement _(Without escrow)_

- Signatures: _Customer_ + _Merchant_

The _customer_ can request a refund when the _merchant_ failed to fulfil the order. If the _merchant_ accepts the request, he/she can co-sign the transaction and refunds the _customer_.

#### B2) Refund dispute _(Escrow involved)_

- Signatures: _Escrow_ + _Merchant_

In case of the _merchant_ neither agree with the refund claim nor respond to _customer_'s refund request, the _customer_ can reach the _escrow_ to resolve the issue. If the resolution outcome is in favour of the _customer_, _escrow_ will issue a refund to the _customer_ by providing the co-signature.

#### Transaction Flows:

<div>
    <img src="images/PoGSD_1.png" alt="Transaction_Flows_1" />
</div>

<div>
    <img src="images/PoGSD_2.png" alt="Transaction_Flows_2" />
</div>

## License

[Apache 2.0](./LICENSE)
